<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Divélun | Short Educativo</title>
    <link rel="stylesheet" href="https://cdn.plyr.io/3.7.8/plyr.css" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --brand-blue: #0066FF;
            --brand-dark: #1A202C;
            --brand-gray: #718096;
            --plyr-color-main: var(--brand-blue);
        }

        body { 
            margin: 0; 
            padding: 0; 
            background: #000000; /* Fondo negro para mejor contraste */
            font-family: 'Inter', sans-serif; 
            color: white; 
            overflow-x: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        /* --- CONTENEDOR PRINCIPAL VERTICAL (SHORT) --- */
        .short-container {
            width: 100%;
            max-width: 360px; /* Ancho típico de un Short vertical */
            position: relative;
            margin: 0 auto;
            background: #000;
            border-radius: 0;
            overflow: hidden;
            box-shadow: 0 0 60px rgba(0, 102, 255, 0.2);
        }

        /* --- VIDEO BOX VERTICAL --- */
        .video-box-short {
            position: relative;
            width: 100%;
            aspect-ratio: 9/16; /* Relación vertical para Shorts */
            overflow: hidden;
            line-height: 0;
            z-index: 0;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
            background: #000;
        }

        /* --- FEEDBACK VISUAL PARA SHORTS --- */
        .tap-feedback-short {
            position: absolute;
            top: 0;
            height: 100%;
            width: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(0, 102, 255, 0.08);
            opacity: 0;
            pointer-events: none;
            z-index: 5;
            transition: opacity 0.3s ease;
        }
        .tap-feedback-short.left { 
            left: 0; 
            border-radius: 0;
        }
        .tap-feedback-short.right { 
            right: 0; 
            border-radius: 0;
        }
        .tap-icon-short { 
            color: white; 
            transform: scale(0.7); 
            transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); 
        }
        .tap-feedback-short.animate { 
            opacity: 1; 
        }
        .tap-feedback-short.animate .tap-icon-short { 
            transform: scale(1.1); 
        }

        /* --- BOTÓN INICIO PARA SHORTS --- */
        .start-screen-short {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 20;
            cursor: pointer;
            transition: opacity 0.5s ease, visibility 0.5s;
        }
        .start-screen-short.hidden { 
            opacity: 0; 
            visibility: hidden; 
            pointer-events: none; 
        }
        
        .big-play-btn-short { 
            width: 100px;
            height: 50px;
            background: var(--brand-blue);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 8px 25px rgba(0, 102, 255, 0.5);
            border-radius: 0; /* Rectangular sin esquinas */
            border: none;
        }
        
        .big-play-btn-short svg {
            width: 24px;
            height: 24px;
            fill: white;
        }

        /* --- BANNER DE RECURSOS PARA SHORTS --- */
        .premium-banner-short {
            position: absolute;
            bottom: 20px;
            right: 15px;
            background: var(--brand-blue);
            color: #ffffff;
            padding: 10px 18px;
            display: flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
            z-index: 15;
            border-radius: 4px;
            opacity: 1;
            transition: opacity 0.6s ease;
            box-shadow: 0 4px 15px rgba(0, 102, 255, 0.4);
            font-weight: 800;
            font-size: 0.75rem;
        }
        .premium-banner-short.force-hide { 
            opacity: 0; 
            pointer-events: none; 
        }

        /* --- CONTROLES DE PLYR MODIFICADOS PARA SHORTS --- */
        .plyr__controls {
            background: linear-gradient(transparent, rgba(0,0,0,0.7)) !important;
            padding: 10px 12px !important;
            min-height: 50px !important;
        }
        
        /* Barra de progreso más corta y centrada */
        .plyr__progress {
            flex: 0 0 auto !important;
            width: 60px !important;
            margin: 0 auto !important;
            order: 1;
        }
        
        /* Duración visible y centrada */
        .plyr__time--duration {
            display: block !important;
            visibility: visible !important;
            font-size: 0.7rem !important;
            font-weight: 700 !important;
            color: white !important;
            margin: 0 auto !important;
            order: 2;
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            bottom: 8px;
        }
        
        /* Ocultar tiempo actual y otros controles no necesarios */
        .plyr__time--current { 
            display: none !important; 
        }
        
        /* Botón de play más pequeño y centrado */
        .plyr__control--play {
            order: 0;
            margin-right: 0 !important;
        }
        
        /* Ocultar otros controles que no necesitamos para Shorts */
        .plyr__controls .plyr__controls__item:not(.plyr__control--play):not(.plyr__progress):not(.plyr__time--duration) {
            display: none !important;
        }

        /* --- CONTENIDO INFORMATIVO DEBAJO DEL SHORT --- */
        .short-info {
            padding: 18px 20px;
            background: #1A202C;
            color: white;
            border-top: 1px solid #2D3748;
        }
        
        .short-title {
            font-size: 1.2rem;
            font-weight: 700;
            margin: 0 0 8px 0;
            color: white;
        }
        
        .short-description {
            font-size: 0.9rem;
            color: #CBD5E0;
            line-height: 1.5;
            margin: 0 0 15px 0;
        }
        
        .short-actions {
            display: flex;
            gap: 10px;
        }
        
        .short-action-btn {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .short-action-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .short-action-btn.primary {
            background: var(--brand-blue);
        }
        
        .short-action-btn.primary:hover {
            background: #0052CC;
        }
    </style>
</head>
<body>

    <div class="short-container">
        <div class="video-box-short" id="videoWrapperShort">
            
            <!-- Feedback visual para doble toque -->
            <div class="tap-feedback-short left" id="feedbackLeftShort">
                <div class="tap-icon-short">
                    <svg width="36" height="36" viewBox="0 0 24 24" fill="white">
                        <path d="M11 19l-7-7 7-7m8 14l-7-7 7-7"/>
                    </svg>
                </div>
            </div>
            
            <div class="tap-feedback-short right" id="feedbackRightShort">
                <div class="tap-icon-short">
                    <svg width="36" height="36" viewBox="0 0 24 24" fill="white">
                        <path d="M13 5l7 7-7 7M5 5l7 7-7 7"/>
                    </svg>
                </div>
            </div>

            <!-- Overlay de inicio con botón rectangular azul -->
            <div class="start-screen-short" id="startScreenShort">
                <div class="big-play-btn-short">
                    <svg viewBox="0 0 24 24">
                        <path d="M8 5v14l11-7z"/>
                    </svg>
                </div>
            </div>

            <!-- Banner de recursos azul -->
            <a href="short-material.pdf" download class="premium-banner-short" id="bannerMaterialShort">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                    <polyline points="7 10 12 15 17 10"></polyline>
                    <line x1="12" y1="15" x2="12" y2="3"></line>
                </svg>
                <span>APUNTES</span>
            </a>
            
            <!-- Reproductor Plyr con el Short de YouTube -->
            <div id="playerShort" data-plyr-provider="youtube" data-plyr-embed-id="1mGXae-LCiM"></div>
        </div>
        
        <!-- Información del Short -->
        <div class="short-info">
            <h2 class="short-title">Técnica Rápida: Mejora tu Pronunciación</h2>
            <p class="short-description">Aprende un ejercicio de 60 segundos para perfeccionar tu acento en japonés. Usa el doble toque a los lados para repetir fragmentos clave.</p>
            <div class="short-actions">
                <button class="short-action-btn primary">Guardar Short</button>
                <button class="short-action-btn">Compartir</button>
            </div>
        </div>
    </div>

    <script src="https://cdn.plyr.io/3.7.8/plyr.polyfilled.js"></script>
    <script>
        // Inicializar reproductor para el Short
        const playerShort = new Plyr('#playerShort', {
            controls: ['play', 'progress', 'duration'], 
            fullscreen: { enabled: true },
            ratio: '9:16', // Forzar relación vertical para Shorts
            youtube: { 
                noCookie: true, 
                rel: 0, 
                modestbranding: 1,
                // Configuraciones específicas para Shorts
                playsinline: 1
            }
        });

        // Referencias a elementos del DOM
        const bannerShort = document.getElementById('bannerMaterialShort');
        const startScreenShort = document.getElementById('startScreenShort');
        const wrapperShort = document.getElementById('videoWrapperShort');
        let hideTimerShort;
        let lastTapTimeShort = 0;
        let hasStartedShort = false;

        // Controlar overlay de inicio
        startScreenShort.addEventListener('click', () => { 
            if (!hasStartedShort) {
                playerShort.play(); 
            }
        });
        
        playerShort.on('playing', () => { 
            if (!hasStartedShort) { 
                startScreenShort.classList.add('hidden'); 
                hasStartedShort = true; 
            } 
        });
        
        playerShort.on('pause', () => {
            // Mostrar overlay de inicio solo si no es una pausa momentánea
            setTimeout(() => {
                if (playerShort.paused && hasStartedShort) {
                    startScreenShort.classList.remove('hidden');
                }
            }, 300);
        });

        // Controlar visibilidad del banner y controles
        playerShort.on('controlsshown', () => { 
            clearTimeout(hideTimerShort); 
            bannerShort.classList.remove('force-hide');
        });

        playerShort.on('controlshidden', () => { 
            hideTimerShort = setTimeout(() => { 
                bannerShort.classList.add('force-hide');
            }, 1500); 
        });

        // Función para manejar el doble toque en Shorts
        const handleDoubleActionShort = (e) => {
            // No activar si se tocan los controles o el banner
            if (e.target.closest('.plyr__controls') || e.target.closest('.premium-banner-short')) return;
            
            const now = Date.now();
            if (now - lastTapTimeShort < 300) {
                e.preventDefault();
                const rect = wrapperShort.getBoundingClientRect();
                const x = (e.clientX || (e.changedTouches && e.changedTouches[0].clientX)) - rect.left;
                
                if (x < rect.width / 2) { 
                    // Tocar lado izquierdo: retroceder 5 segundos
                    playerShort.rewind(5); 
                    showFeedbackShort(document.getElementById('feedbackLeftShort'));
                } else { 
                    // Tocar lado derecho: avanzar 5 segundos
                    playerShort.forward(5); 
                    showFeedbackShort(document.getElementById('feedbackRightShort'));
                }
            }
            lastTapTimeShort = now;
        };

        // Mostrar feedback visual
        const showFeedbackShort = (el) => {
            if (!el) return;
            
            el.classList.remove('animate'); 
            void el.offsetWidth; // Forzar reflow
            el.classList.add('animate');
            
            setTimeout(() => {
                el.classList.remove('animate');
            }, 500);
        };

        // Event listeners para interacción táctil y de ratón
        wrapperShort.addEventListener('click', handleDoubleActionShort);
        wrapperShort.addEventListener('touchend', handleDoubleActionShort);
        wrapperShort.addEventListener('dblclick', (e) => e.preventDefault(), true);
        
        // Reproducir automáticamente al hacer scroll en la vista (simulación)
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting && !hasStartedShort) {
                    // playerShort.play(); // Descomentar para reproducción automática
                }
            });
        }, { threshold: 0.5 });
        
        observer.observe(wrapperShort);
    </script>
</body>
</html>
